# Planner Prompting Guidelines for socialvibe Executors

## 1. Purpose

This document provides guidelines for Planners (Gemini and Grok) on how to create effective, clear, and executable prompts for the Executor AIs (Claude and O3) working on the socialvibe project. Adherence to these guidelines is crucial for efficient development and minimizing errors.

**In addition to these guidelines, Planners MUST consult `docs/knowledge.md` as the primary source of comprehensive project context, current status, and key decisions before generating any execution prompts. Planners are also responsible for updating `docs/knowledge.md` with significant new decisions.**

When a user (George or Mihnea) initiates a task with Gemini or Grok, the Planners should refer to this document to structure their own process and the subsequent prompts for Executors. The user will provide the `socialvibe` project folder, making this document (and all others in `docs/`) accessible context for the Planners.

## 2. Core Principles for Prompts

* **Clarity & Specificity:** Prompts must be unambiguous. Clearly define the task, the expected outcome, and the exact steps or content required.
* **No Ambiguity:** Avoid vague language or instructions that could be interpreted in multiple ways.
* **Self-Contained (or Clearly Referenced):** Provide all necessary information within the prompt or by precise reference to existing, accessible project files (e.g., "refer to the schema in `docs/05_data_models.md` for field names").
* **Adherence to Guardrails:** All prompts must remind Executors to follow `docs/07_guardrails.md`.
* **Idempotency (where possible):** Design prompts so that if an Executor had to re-run a *successful* prompt, it wouldn't cause negative side effects (this is not always possible but a good principle).

## 3. Prompt Structure and Format

* **Delivery Format:** All execution prompts must be delivered to Executors as **raw markdown, typically within fenced code blocks.**
* **Task Definition:** Start with a clear, concise statement of what the Executor needs to accomplish.
* **File Path Specification:**
    * Always provide file paths relative to the project root (e.g., `src/agent/tools/scraper.py`, `docs/02_roadmap.md`).
    * **Crucially, Planners (Gemini, Grok) MUST NEVER explicitly write the root folder's name (e.g., "socialvibe") in these paths within prompts for Executors.** The Executor operates with the root as its implicit current working directory.
* **Code/Content Instructions:**
    * For new code/content: Provide the exact code block or text to be inserted.
    * For modifications: Clearly specify the file, the location within the file (e.g., "after function `xyz()`," "replace the content of section 3.2"), and the exact changes to be made. Show the "before" and "after" or use diff-like instructions if it aids clarity for complex changes.
* **Tool Usage:** If the Executor needs to be prompted to *simulate* or *prepare a call* to a tool (as Executors don't call LangGraph tools directly, but Planners might ask them to generate the *parameters* for a tool call), be explicit about the tool name and required parameters.
* **Guardrail Reminder:** Include a standard reminder, e.g., "Remember to strictly follow all guardrails defined in `docs/07_guardrails.md`."
* **Reporting:** Instruct the Executor to report success clearly or provide full error details upon failure.

## 4. Git Commit Workflow Integration

This is a critical part of the development process and must be managed by Planners in their instructions.

* **For Successful Executions:**
    1.  The Executor's prompt should include a final step asking it to confirm successful completion of all specified actions and to report this to the human operator (George/Mihnea).
    2.  The Executor must then request and wait for explicit confirmation of successful completion from the operator.
    3.  If, and only if, the operator confirms success, the Planner (Gemini, after Grok consultation) provides the exact git commit message to the Executor.
    4.  The Executor is responsible for staging and committing the changes using the provided commit message, and then reports the outcome.
    5.  **Planners MUST explicitly instruct Executors in their prompts to perform the git commit directly after operator confirmation, using the provided commit message. Executors do not need to inform the Planner again after operator confirmationâ€”commit should proceed immediately.**
* **For Unsuccessful Executions:**
    1.  If the Executor reports an error it cannot resolve, or fails to complete the task as specified, **NO git commit instruction should be generated by the Planner for that failed attempt's (potentially partial or incorrect) changes.**
    2.  The Planners will then analyze the failure (following the "Reflect, Distill, Validate" protocol) and issue new, revised prompts to the Executor.

## 5. Handling Executor Feedback

* **Success:** Acknowledge and proceed to the git commit instruction step (for the human user).
* **Failure:**
    * Analyze the error message and any context provided by the Executor.
    * Consult Grok for debugging strategy.
    * Do not ask the same Executor to retry the exact same failed prompt without modification unless the failure was clearly transient (e.g., a brief network blip, though even then, consider robustness).
    * Formulate a new, revised prompt to address the cause of the failure.

## 6. Task Escalation (Claude to O3)

* Planners should assign tasks to Claude by default.
* If Claude consistently fails at a task after 1-2 *revised* prompts from the Planners, or if a task is initially assessed by Planners as highly complex or requiring nuanced understanding beyond Claude's typical capabilities, Planners should then generate a prompt for O3.
* The prompt for O3 should include context of Claude's previous attempts and failures if relevant.

## 7. Executor Decision-Making Authority

* **Claude:** Has very little to no decision-making authority. Executes instructions precisely. May be allowed to fix obvious typos in non-code text if explicitly stated in the prompt.
* **O3:** While O3 also executes precise instructions, it may be given some latitude by Planners in *how* to debug a complex issue if the prompt explicitly grants this (e.g., "O3, attempt to fix the error in `module_x.py` that causes `TestY` to fail. You may use your judgment to add logging, refactor the problematic section, or consult relevant documentation snippets to achieve a fix. Report your chosen method and outcome."). However, the *overall goal* or *what problem to solve* is always defined by the Planners.

## 8. Review and Iteration

These guidelines are a living document. Planners (Gemini and Grok) should discuss and propose updates to these guidelines as the project evolves and new best practices emerge, with final approval from the Tech Lead (George). 