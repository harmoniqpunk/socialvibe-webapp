# Architecture: SocialVibe WebApp

## 1. Overview

The SocialVibe WebApp is a modern frontend application built with SvelteKit and TypeScript. It is designed to be a highly interactive dashboard for managing social media engagement. The application integrates a Rust-based WebAssembly (WASM) module for specific client-side functionalities and is deployed via Cloudflare Pages.

## 2. Core Technologies

* **Framework:** SvelteKit ([`svelte.config.js`](../../svelte.config.js), [`vite.config.ts`](../../vite.config.ts))
* **Language:** TypeScript ([`tsconfig.json`](../../tsconfig.json))
* **Styling:** Tailwind CSS ([`tailwind.config.ts`](../../tailwind.config.ts), [`app.css`](../../src/app.css))
    * **UI Components:** Flowbite Svelte (as indicated by dependencies in [`package.json`](../../package.json))
* **WebAssembly (WASM):**
    * Rust for WASM module development ([`socialvibe-lib/`](../../socialvibe-lib/))
    * `wasm-pack` for building the Rust library into a WASM package ([`package.json`](../../package.json) scripts: `wasm`, `build-wasm`)
    * Integration with SvelteKit via JS bindings generated by `wasm-pack` ([`src/lib/index.ts`](../../src/lib/index.ts) initializes the WASM module).
* **Build Tool:** Vite (managed by SvelteKit)
* **Testing:**
    * Unit/Component Tests: Vitest ([`src/index.test.ts`](../../src/index.test.ts))
    * End-to-End Tests: Playwright ([`playwright.config.ts`](../../playwright.config.ts), [`tests/test.ts`](../../tests/test.ts))
* **Linting & Formatting:**
    * ESLint ([`eslint.config.js`](../../eslint.config.js))
    * Prettier ([`package.json`](../../package.json) scripts for format/check)
* **Deployment:** Cloudflare Pages (via Wrangler CLI for manual deployments, see [`README.md`](../../README.md))

## 3. Project Structure

Key directories and files:

* **`socialvibe-webapp/` (Root)**
    * `src/`: Main SvelteKit application code.
        * `app.html`: Main HTML template.
        * `app.css`: Global styles, Tailwind directives.
        * `app.d.ts`: Global TypeScript type definitions for SvelteKit.
        * `hooks.client.ts` / `hooks.server.ts` (if any): SvelteKit hooks.
        * `lib/`: Shared modules, components, stores, and utilities.
            * `socialvibe_lib/`: Copied WASM package files (`.js`, `.wasm`, `.d.ts`).
            * `index.ts`: Main entry for WASM module initialization.
            * `types/`: TypeScript interfaces and types (e.g., `twitter.ts`).
            * `stores/`: Svelte stores (e.g., `filterStore.ts`).
            * `style/`: Styling-related files like `colors.ts`.
            * Components: Svelte components (`.svelte` files).
        * `routes/`: Defines the application's pages and API routes.
        * `service-worker.ts` (if any): For PWA capabilities.
    * `socialvibe-lib/`: Rust source code for the WebAssembly module.
        * `src/lib.rs`: Rust library entry point.
        * `Cargo.toml`: Rust package manifest.
        * `pkg/`: Generated WASM package (should be in `.gitignore` if copied to `src/lib/socialvibe_lib/`).
    * `static/`: Static assets (favicon, images, etc.).
    * `tests/`: Playwright E2E tests.
    * `mihneas-mock/`: Contains React-based mock components; likely for reference or earlier prototyping, not directly part of the SvelteKit build.
    * Configuration Files: `svelte.config.js`, `vite.config.ts`, `tailwind.config.ts`, `postcss.config.js`, `tsconfig.json`, `package.json`, `wrangler.toml` (if used for Cloudflare dev).

## 4. Data Flow & State Management

* **Svelte Stores:** Client-side state management is handled using Svelte stores ([`src/lib/stores.ts`](../../src/lib/stores.ts)).
* **Props & Events:** Component communication follows standard Svelte patterns.
* **API Interaction:** The frontend will likely interact with backend APIs (not defined in this repository) for fetching social media data, user authentication, etc. If it's a purely client-side demo with mock data, this is sourced from files like [`src/lib/mockTwitterData.ts`](../../src/lib/mockTwitterData.ts).
* **WASM Interaction:** TypeScript code in `src/lib/` can import and call functions exported from the WASM module.

## 5. Build Process

1.  **WASM Build:** `npm run wasm` (or `npm run build-wasm`) compiles the Rust code in `socialvibe-lib/` into a WASM package using `wasm-pack`. The output (`.wasm`, `.js` wrapper, `.d.ts` types) is then typically copied to `src/lib/socialvibe_lib/` by the `copy-pkg` script.
2.  **SvelteKit Build:** `vite build` (triggered by `npm run build`) compiles the Svelte/TypeScript application, processes CSS with Tailwind, and bundles everything for production.
    * Vite handles TypeScript compilation, Svelte compilation, and asset bundling.
    * The `vite-plugin-top-level-await` plugin is used, which might be relevant for WASM initialization.

## 6. Deployment

* The application is deployed to Cloudflare Pages.
* Due to the custom WASM build step, deployment is manual using `wrangler pages deploy ./.wrangler/dist/functions` (or similar, as per `package.json` "deploy" script). Automatic Git-based deployments by Cloudflare are not suitable without custom build commands that Cloudflare's environment can run.

## 7. Key Architectural Considerations

* **Client-Side Focus:** Primarily a frontend application.
* **Modularity:** WASM module allows for separation of complex or performance-sensitive logic.
* **Reactivity:** Svelte provides fine-grained reactivity for UI updates.
* **Styling Efficiency:** Tailwind CSS for utility-first styling.
* **Type Safety:** TypeScript enhances code quality and maintainability.